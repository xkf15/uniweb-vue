{"version":3,"sources":["../../build/dev-server.js"],"names":["require","browserSync","historyApiFallback","config","process","env","NODE_ENV","JSON","parse","dev","opn","path","express","webpack","proxyMiddleware","webpackConfig","port","PORT","autoOpenBrowser","proxyTable","app","compiler","devMiddleware","publicPath","output","quiet","hotMiddleware","log","plugin","compilation","data","cb","publish","action","forEach","context","options","target","use","filter","staticPath","posix","join","assetsPublicPath","assetsSubDirectory","static","uri","waitUntilValid","console","ui","server","baseDir","middleware","files"],"mappings":";;;;;;;;AAAAA,QAAQ,kBAAR;;AAEA,IAAIC,cAAcD,QAAQ,cAAR,CAAlB;AACA,IAAIE,qBAAqBF,QAAQ,8BAAR,CAAzB;;AAEA,IAAIG,SAASH,QAAQ,WAAR,CAAb;AACA,IAAI,CAACI,QAAQC,GAAR,CAAYC,QAAjB,EAA2B;AACzBF,UAAQC,GAAR,CAAYC,QAAZ,GAAuBC,KAAKC,KAAL,CAAWL,OAAOM,GAAP,CAAWJ,GAAX,CAAeC,QAA1B,CAAvB;AACD;;AAED,IAAII,MAAMV,QAAQ,KAAR,CAAV;AACA,IAAIW,OAAOX,QAAQ,MAAR,CAAX;AACA,IAAIY,UAAUZ,QAAQ,SAAR,CAAd;AACA,IAAIa,UAAUb,QAAQ,SAAR,CAAd;AACA,IAAIc,kBAAkBd,QAAQ,uBAAR,CAAtB;AACA,IAAIe,gBAAgBX,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,SAAzB,GAChBN,QAAQ,qBAAR,CADgB,GAEhBA,QAAQ,oBAAR,CAFJ;;AAKA,IAAIgB,OAAOZ,QAAQC,GAAR,CAAYY,IAAZ,IAAoBd,OAAOM,GAAP,CAAWO,IAA1C;;AAEA,IAAIE,kBAAkB,CAAC,CAACf,OAAOM,GAAP,CAAWS,eAAnC;;AAGA,IAAIC,aAAahB,OAAOM,GAAP,CAAWU,UAA5B;;AAEA,IAAIC,MAAMR,SAAV;AACA,IAAIS,WAAWR,QAAQE,aAAR,CAAf;;AAEA,IAAIO,gBAAgBtB,QAAQ,wBAAR,EAAkCqB,QAAlC,EAA4C;AAC9DE,cAAYR,cAAcS,MAAd,CAAqBD,UAD6B;AAE9DE,SAAO;AAFuD,CAA5C,CAApB;;AAKA,IAAIC,gBAAgB1B,QAAQ,wBAAR,EAAkCqB,QAAlC,EAA4C;AAC9DM,OAAK,eAAM,CAAE;AADiD,CAA5C,CAApB;;AAIAN,SAASO,MAAT,CAAgB,aAAhB,EAA+B,UAAUC,WAAV,EAAuB;AACpDA,cAAYD,MAAZ,CAAmB,gCAAnB,EAAqD,UAAUE,IAAV,EAAgBC,EAAhB,EAAoB;AACvEL,kBAAcM,OAAd,CAAsB,EAAEC,QAAQ,QAAV,EAAtB;AACAF;AACD,GAHD;AAID,CALD;;AAQA,oBAAYZ,UAAZ,EAAwBe,OAAxB,CAAgC,UAAUC,OAAV,EAAmB;AACjD,MAAIC,UAAUjB,WAAWgB,OAAX,CAAd;AACA,MAAI,OAAOC,OAAP,KAAmB,QAAvB,EAAiC;AAC/BA,cAAU,EAAEC,QAAQD,OAAV,EAAV;AACD;AACDhB,MAAIkB,GAAJ,CAAQxB,gBAAgBsB,QAAQG,MAAR,IAAkBJ,OAAlC,EAA2CC,OAA3C,CAAR;AACD,CAND;;AASAhB,IAAIkB,GAAJ,CAAQpC,oBAAR;;AAGAkB,IAAIkB,GAAJ,CAAQhB,aAAR;;AAIAF,IAAIkB,GAAJ,CAAQZ,aAAR;;AAGA,IAAIc,aAAa7B,KAAK8B,KAAL,CAAWC,IAAX,CAAgBvC,OAAOM,GAAP,CAAWkC,gBAA3B,EAA6CxC,OAAOM,GAAP,CAAWmC,kBAAxD,CAAjB;AACAxB,IAAIkB,GAAJ,CAAQE,UAAR,EAAoB5B,QAAQiC,MAAR,CAAe,UAAf,CAApB;;AAEA,IAAIC,MAAM,sBAAsB9B,IAAhC;;AAEAM,cAAcyB,cAAd,CAA6B,YAAY;AACvCC,UAAQrB,GAAR,CAAY,oBAAoBmB,GAApB,GAA0B,IAAtC;AACD,CAFD;;AAKA7C,YAAY;AACVe,QAAM,IADI;AAEViC,MAAI;AACFjC,UAAM;AADJ,GAFM;AAKVkC,UAAQ;AACNC,aAAS,QADH;;AAGNC,gBAAY,CACVlD,oBADU,EAEVoB,aAFU,EAGVI,aAHU;AAHN,GALE;;AAiBV2B,SAAO,CACL,eADK;AAjBG,CAAZ","file":"dev-server.js","sourcesContent":["require('./check-versions')()\n\nvar browserSync = require('browser-sync')\nvar historyApiFallback = require('connect-history-api-fallback')\n\nvar config = require('../config')\nif (!process.env.NODE_ENV) {\n  process.env.NODE_ENV = JSON.parse(config.dev.env.NODE_ENV)\n}\n\nvar opn = require('opn')\nvar path = require('path')\nvar express = require('express')\nvar webpack = require('webpack')\nvar proxyMiddleware = require('http-proxy-middleware')\nvar webpackConfig = process.env.NODE_ENV === 'testing'\n  ? require('./webpack.prod.conf')\n  : require('./webpack.dev.conf')\n\n// default port where dev server listens for incoming traffic\nvar port = process.env.PORT || config.dev.port\n// automatically open browser, if not set will be false\nvar autoOpenBrowser = !!config.dev.autoOpenBrowser\n// Define HTTP proxies to your custom API backend\n// https://github.com/chimurai/http-proxy-middleware\nvar proxyTable = config.dev.proxyTable\n\nvar app = express()\nvar compiler = webpack(webpackConfig)\n\nvar devMiddleware = require('webpack-dev-middleware')(compiler, {\n  publicPath: webpackConfig.output.publicPath,\n  quiet: true\n})\n\nvar hotMiddleware = require('webpack-hot-middleware')(compiler, {\n  log: () => {}\n})\n// force page reload when html-webpack-plugin template changes\ncompiler.plugin('compilation', function (compilation) {\n  compilation.plugin('html-webpack-plugin-after-emit', function (data, cb) {\n    hotMiddleware.publish({ action: 'reload' })\n    cb()\n  })\n})\n\n// proxy api requests\nObject.keys(proxyTable).forEach(function (context) {\n  var options = proxyTable[context]\n  if (typeof options === 'string') {\n    options = { target: options }\n  }\n  app.use(proxyMiddleware(options.filter || context, options))\n})\n\n// handle fallback for HTML5 history API\napp.use(historyApiFallback())\n\n// serve webpack bundle output\napp.use(devMiddleware)\n\n// enable hot-reload and state-preserving\n// compilation error display\napp.use(hotMiddleware)\n\n// serve pure static assets\nvar staticPath = path.posix.join(config.dev.assetsPublicPath, config.dev.assetsSubDirectory)\napp.use(staticPath, express.static('./static'))\n\nvar uri = 'http://localhost:' + port\n\ndevMiddleware.waitUntilValid(function () {\n  console.log('> Listening at ' + uri + '\\n')\n})\n\n\nbrowserSync({\n  port: 8888,\n  ui: {\n    port: 8889\n  },\n  server: {\n    baseDir: '../src',\n\n    middleware: [\n      historyApiFallback(),\n      devMiddleware,\n      hotMiddleware\n    ]\n  },\n\n  // no need to watch '*.js' here, webpack will take care of it for us,\n  // including full page reloads if HMR won't work\n  files: [\n    '../src/*.html'\n  ]\n})\n\n// module.exports = app.listen(port, function (err) {\n//   if (err) {\n//     console.log(err)\n//     return\n//   }\n\n//   // when env is testing, don't need open it\n//   if (autoOpenBrowser && process.env.NODE_ENV !== 'testing') {\n//     opn(uri)\n//   }\n// })\n"]}